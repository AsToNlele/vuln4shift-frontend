import React, { Fragment } from 'react';
import propTypes from 'prop-types';
import { Label, Popover } from '@patternfly/react-core';

const KnownExploitLabel = ({ isCompact, labelProps }) => (
  <Popover
    className="known-exploit-popover"
    appendTo={document.querySelector('.ocpVulnerability')}
    bodyContent={
      <Fragment>
        This CVE is identified with a <b>“Known exploit”</b> label because Red
        Hat has determined this CVE has a public exploit.
        <br /> <br />
        This CVE is unpatched on your cluster. CVEs with this label should be
        addressed with <b>high priority</b> due to the risks posed by them.
        <br /> <br />
        “Known exploit” does not mean we have taken steps to determine if the
        CVE has been exploited in your environment.
      </Fragment>
    }
  >
    <Label
      color="red"
      isCompact={isCompact}
      {...labelProps}
      style={{ cursor: 'pointer', ...labelProps.style }}
    >
      Known exploit
    </Label>
  </Popover>
);

KnownExploitLabel.propTypes = {
  isCompact: propTypes.bool,
  labelProps: propTypes.object,
};

export default KnownExploitLabel;
